<!-- Modernized profile UI (Tailwind v3) -- added gradients, glass cards, motion, dark-mode friendly classes -->
<div class="relative">
  <!-- Soft radial background accent -->
  <div class="pointer-events-none absolute inset-0 -z-10">
    <div
      class="absolute inset-0 bg-gradient-to-br from-primary-50 via-white to-slate-100 dark:from-slate-900 dark:via-slate-900 dark:to-slate-800"
    ></div>
    <div
      class="absolute top-1/3 left-1/2 -translate-x-1/2 w-[40rem] h-[40rem] rounded-full bg-primary-400/10 dark:bg-primary-500/10 blur-3xl"
    ></div>
  </div>
</div>
<div class="max-w-5xl mx-auto px-4 md:px-8 py-10 space-y-10">
  <!-- Profile Header -->
  <div
    class="flex flex-col md:flex-row items-center gap-6 bg-white/70 dark:bg-slate-800/60 backdrop-blur rounded-2xl px-6 py-6 shadow-sm ring-1 ring-slate-200/60 dark:ring-slate-700/60"
  >
    <div class="relative group">
      <p-avatar
        [image]="user.avatarUrl || 'assets/profile-avatar.jpg'"
        shape="circle"
        size="xlarge"
        class="ring-4 ring-primary-500 transition duration-300 group-hover:scale-105"
      ></p-avatar>
      <!-- Decorative gradient ring -->
      <span
        class="absolute inset-0 -z-10 rounded-full p-[2px] bg-gradient-to-tr from-primary-400 via-primary-300 to-indigo-400 opacity-0 group-hover:opacity-70 transition"
        aria-hidden="true"
      ></span>
      <span class="absolute bottom-0 right-0">
        <p-button
          icon="pi pi-upload"
          size="small"
          severity="primary"
          [rounded]="true"
          (onClick)="fileInput.click()"
        ></p-button>
        <input
          #fileInput
          type="file"
          class="hidden"
          (change)="onAvatarChange($event)"
        />
      </span>
    </div>
    <div class="flex-1 space-y-3">
      <h2 class="text-3xl font-semibold tracking-tight flex items-center gap-2">
        {{ user.name }}
        <span
          class="inline-flex items-center rounded-full bg-primary-100 dark:bg-primary-500/20 text-primary-700 dark:text-primary-200 px-2 py-0.5 text-xs font-medium"
          >Pro Reader</span
        >
      </h2>
      <p
        class="text-slate-500 dark:text-slate-400 text-sm flex flex-wrap items-center gap-2"
      >
        üìç {{ user.location }} <span class="hidden sm:inline">¬∑</span> Joined
        {{ user.joined }}
      </p>
      <div class="flex gap-2 flex-wrap pt-1">
        <p-button
          label="Edit Profile"
          icon="pi pi-user-edit"
          severity="primary"
          styleClass="!shadow-none hover:!shadow"
        ></p-button>
        <p-button
          label="Share"
          icon="pi pi-link"
          severity="secondary"
          (onClick)="copyShareLink()"
          styleClass="!shadow-none hover:!shadow"
        ></p-button>
        <p-button
          label="Settings"
          icon="pi pi-cog"
          severity="help"
          styleClass="!shadow-none hover:!shadow"
        ></p-button>
      </div>
    </div>
  </div>

  <!-- Quick Stats -->
  <div class="grid grid-cols-1 sm:grid-cols-3 gap-5">
    <div
      class="relative group overflow-hidden rounded-xl bg-white/80 dark:bg-slate-800/70 backdrop-blur p-5 text-center ring-1 ring-slate-200/60 dark:ring-slate-700/60 shadow-sm transition-all duration-300 hover:shadow-lg hover:-translate-y-0.5"
    >
      <div
        class="absolute inset-0 opacity-0 group-hover:opacity-100 bg-gradient-to-br from-primary-50/60 to-transparent dark:from-primary-500/10 transition"
      ></div>
      <p class="text-gray-500 text-sm">Books Read</p>
      <p class="text-3xl font-bold tracking-tight relative">
        {{ user.stats.booksRead }}
      </p>
      <p
        class="text-[10px] uppercase mt-1 text-primary-600 dark:text-primary-400 tracking-wider"
      >
        Total
      </p>
    </div>
    <div
      class="relative group overflow-hidden rounded-xl bg-white/80 dark:bg-slate-800/70 backdrop-blur p-5 text-center ring-1 ring-slate-200/60 dark:ring-slate-700/60 shadow-sm transition-all duration-300 hover:shadow-lg hover:-translate-y-0.5"
    >
      <div
        class="absolute inset-0 opacity-0 group-hover:opacity-100 bg-gradient-to-br from-fuchsia-50/70 to-transparent dark:from-fuchsia-500/10 transition"
      ></div>
      <p class="text-gray-500 text-sm">Quotes</p>
      <p class="text-3xl font-bold tracking-tight relative">
        {{ user.stats.quotes }}
      </p>
      <p
        class="text-[10px] uppercase mt-1 text-fuchsia-600 dark:text-fuchsia-400 tracking-wider"
      >
        Saved
      </p>
    </div>
    <div
      class="relative group overflow-hidden rounded-xl bg-white/80 dark:bg-slate-800/70 backdrop-blur p-5 text-center ring-1 ring-slate-200/60 dark:ring-slate-700/60 shadow-sm transition-all duration-300 hover:shadow-lg hover:-translate-y-0.5"
    >
      <div
        class="absolute inset-0 opacity-0 group-hover:opacity-100 bg-gradient-to-br from-amber-50/70 to-transparent dark:from-amber-500/10 transition"
      ></div>
      <p class="text-gray-500 text-sm">Avg Rating</p>
      <p
        class="text-3xl font-bold tracking-tight relative flex items-center justify-center gap-1"
      >
        ‚≠ê <span>{{ user.stats.avgRating }}</span>
      </p>
      <p
        class="text-[10px] uppercase mt-1 text-amber-600 dark:text-amber-400 tracking-wider"
      >
        Score
      </p>
    </div>
  </div>

  <!-- Mini Goals Overview -->
  <div class="grid grid-cols-1 sm:grid-cols-3 gap-5">
    <p-card class="modern-card">
      <div class="flex justify-between items-center mb-2">
        <span class="font-medium">Annual Goal</span>
        <p-tag
          severity="info"
          [value]="annualProgressPct + '%'"
          rounded
        ></p-tag>
      </div>
      <p class="text-sm">
        {{ user.stats.booksRead }} / {{ user.goals.annual }} books
      </p>
      <p-progressBar [value]="annualProgressPct"></p-progressBar>
    </p-card>
    <p-card class="modern-card">
      <div class="flex justify-between items-center mb-2">
        <span class="font-medium">Current Streak</span>
        <p-tag
          severity="success"
          [value]="user.goals.streak + ' days'"
          rounded
        ></p-tag>
      </div>
      <div class="flex justify-center py-2">
        <p-knob
          [(ngModel)]="streakProgressPct"
          valueTemplate="{value}%"
          [readonly]="true"
          size="70"
          strokeWidth="10"
          valueColor="var(--p-green-500)"
          rangeColor="var(--p-surface-200)"
        ></p-knob>
      </div>
    </p-card>
    <p-card class="modern-card">
      <div class="flex justify-between items-center mb-2">
        <span class="font-medium">Top Genre</span>
      </div>
      <p class="text-sm">{{ user.readerStats.topGenre }}</p>
    </p-card>
  </div>

  <!-- Featured Book -->
  <p-card class="modern-card overflow-hidden relative">
    <div
      class="absolute -right-10 -top-10 w-40 h-40 bg-primary-400/10 dark:bg-primary-500/10 rounded-full blur-2xl"
    ></div>
    <div class="flex items-center gap-6 relative">
      <img
        [src]="featured.coverUrl"
        alt="Featured book"
        class="w-20 h-28 object-cover rounded-lg shadow-md ring-1 ring-slate-200/60 dark:ring-slate-700/60"
      />
      <div>
        <h3 class="font-semibold mb-1 text-lg">Featured Book</h3>
        <p class="text-sm font-medium">
          {{ featured.title }}
          <span class="text-gray-500 dark:text-slate-400"
            >by {{ featured.author }}</span
          >
        </p>
        <p
          class="text-xs italic text-gray-500 dark:text-slate-400 mt-2 leading-relaxed"
        >
          ‚Äú{{ featured.quote }}‚Äù
        </p>
      </div>
    </div>
  </p-card>

  <!-- Shortcut Links to Detailed Pages -->
  <div class="grid grid-cols-1 sm:grid-cols-3 gap-5">
    <p-card
      class="modern-card group cursor-pointer select-none"
      (click)="navigateTo('reading-log')"
      aria-label="Go to Reading Log"
    >
      <div class="flex flex-col items-center py-6 relative">
        <div
          class="absolute inset-0 opacity-0 group-hover:opacity-100 bg-gradient-to-b from-primary-400/5 to-transparent transition"
        ></div>
        <i
          class="pi pi-book text-2xl mb-2 text-primary-600 dark:text-primary-400 group-hover:scale-110 transition"
        ></i>
        <span class="font-medium">Reading Log</span>
        <span class="text-[11px] mt-1 text-slate-500 dark:text-slate-400"
          >History & Progress</span
        >
      </div>
    </p-card>
    <p-card
      class="modern-card group cursor-pointer select-none"
      (click)="navigateTo('tags')"
      aria-label="Go to Tag Management"
    >
      <div class="flex flex-col items-center py-6 relative">
        <div
          class="absolute inset-0 opacity-0 group-hover:opacity-100 bg-gradient-to-b from-fuchsia-400/5 to-transparent transition"
        ></div>
        <i
          class="pi pi-tags text-2xl mb-2 text-fuchsia-600 dark:text-fuchsia-400 group-hover:scale-110 transition"
        ></i>
        <span class="font-medium">Tag Management</span>
        <span class="text-[11px] mt-1 text-slate-500 dark:text-slate-400"
          >Organize</span
        >
      </div>
    </p-card>
    <p-card
      class="modern-card group cursor-pointer select-none"
      (click)="navigateTo('budget')"
      aria-label="Go to Budget Control"
    >
      <div class="flex flex-col items-center py-6 relative">
        <div
          class="absolute inset-0 opacity-0 group-hover:opacity-100 bg-gradient-to-b from-amber-400/5 to-transparent transition"
        ></div>
        <i
          class="pi pi-wallet text-2xl mb-2 text-amber-600 dark:text-amber-400 group-hover:scale-110 transition"
        ></i>
        <span class="font-medium">Budget Control</span>
        <span class="text-[11px] mt-1 text-slate-500 dark:text-slate-400"
          >Spending</span
        >
      </div>
    </p-card>
  </div>
</div>
