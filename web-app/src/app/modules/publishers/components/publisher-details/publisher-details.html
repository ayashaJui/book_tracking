<div class="max-w-6xl mx-auto p-6 space-y-6">
  <!-- Breadcrumb Navigation -->
  <nav class="flex items-center text-sm text-gray-500 dark:text-gray-400">
    <button 
      (click)="goBack()"
      class="flex items-center gap-1 hover:text-purple-600 dark:hover:text-purple-400 transition-colors"
    >
      <i class="pi pi-chevron-left text-xs"></i>
      <span>Publishers</span>
    </button>
    <i class="pi pi-chevron-right text-xs mx-2"></i>
    <span class="text-gray-700 dark:text-gray-300 font-medium">{{ publisher?.name || 'Publisher Details' }}</span>
  </nav>

  <!-- Header -->
  <div class="bg-white dark:bg-gray-800 rounded-lg shadow-sm p-6">

    <div *ngIf="publisher" class="flex items-start gap-6">
      <!-- Publisher Logo with Image Upload -->
      <div class="flex-shrink-0">
        <app-image-upload
          [entityType]="'publisher'"
          [entityId]="publisher.id || 0"
          [entityName]="publisher.name || ''"
          [currentImageUrl]="publisher.logo || null"
          (imageUploaded)="onImageUploaded($event)"
          (imageRemoved)="onImageRemoved()"
        ></app-image-upload>
      </div>

      <!-- Publisher Info -->
      <div class="flex-1">
        <h1 class="text-3xl font-bold text-gray-900 dark:text-white mb-2">{{ publisher.name }}</h1>
        
        <div class="flex flex-wrap gap-4 text-sm text-gray-600 dark:text-gray-300 mb-4">
          <div *ngIf="publisher.location" class="flex items-center gap-1">
            <i class="pi pi-map-marker"></i>
            <span>{{ publisher.location }}</span>
          </div>
          
          <div *ngIf="publisher.website" class="flex items-center gap-1">
            <i class="pi pi-external-link"></i>
            <a [href]="publisher.website" target="_blank" 
               class="text-blue-600 dark:text-blue-400 hover:underline">
              Visit Website
            </a>
          </div>

          <div *ngIf="publisher.dateAdded" class="flex items-center gap-1">
            <i class="pi pi-calendar"></i>
            <span>Added {{ publisher.dateAdded | date:'MMM yyyy' }}</span>
          </div>

          <div class="flex items-center gap-1">
            <i class="pi pi-book"></i>
            <span>{{ publisher.bookCount }} books</span>
          </div>
        </div>

        <div *ngIf="publisher.description" class="text-gray-700 dark:text-gray-300 leading-relaxed">
          {{ publisher.description }}
        </div>
      </div>
    </div>
  </div>

  <!-- Statistics Overview -->
  <div *ngIf="stats" class="grid grid-cols-1 md:grid-cols-4 gap-4">
    <div class="bg-white dark:bg-gray-800 rounded-lg shadow-sm p-4 text-center">
      <div class="text-2xl font-bold text-blue-600 dark:text-blue-400">{{ stats.totalBooks }}</div>
      <div class="text-sm text-gray-600 dark:text-gray-300">Total Books</div>
    </div>
    
    <div class="bg-white dark:bg-gray-800 rounded-lg shadow-sm p-4 text-center">
      <div class="text-2xl font-bold text-green-600 dark:text-green-400">{{ stats.totalPages | number }}</div>
      <div class="text-sm text-gray-600 dark:text-gray-300">Total Pages</div>
    </div>
    
    <div class="bg-white dark:bg-gray-800 rounded-lg shadow-sm p-4 text-center">
      <div class="text-2xl font-bold text-yellow-600 dark:text-yellow-400">{{ stats.averageRating }}/5</div>
      <div class="text-sm text-gray-600 dark:text-gray-300">Avg Rating</div>
    </div>
    
    <div class="bg-white dark:bg-gray-800 rounded-lg shadow-sm p-4 text-center">
      <div class="text-2xl font-bold text-purple-600 dark:text-purple-400">{{ getStatusCount('Read') }}</div>
      <div class="text-sm text-gray-600 dark:text-gray-300">Books Read</div>
    </div>
  </div>

  <!-- Main Content Grid -->
  <div class="grid grid-cols-1 lg:grid-cols-3 gap-6">
    
    <!-- Books List -->
    <div class="lg:col-span-2 space-y-4">
      <div class="bg-white dark:bg-gray-800 rounded-lg shadow-sm p-6">
        <h2 class="text-xl font-semibold text-gray-900 dark:text-white mb-4 flex items-center gap-2">
          <i class="pi pi-book"></i>
          Books Catalog
        </h2>
        
        <div class="space-y-3">
          <div *ngFor="let book of books" 
               class="border border-gray-200 dark:border-gray-700 rounded-lg p-4 hover:bg-gray-50 dark:hover:bg-gray-700 transition-colors">
            
            <div class="flex justify-between items-start mb-2">
              <h3 class="font-semibold text-gray-900 dark:text-white">{{ book.title }}</h3>
              <span class="px-2 py-1 text-xs rounded-full"
                    [class]="'bg-' + (book.status === 'Read' ? 'green' : book.status === 'Reading' ? 'blue' : book.status === 'On Hold' ? 'yellow' : 'gray') + '-100 text-' + (book.status === 'Read' ? 'green' : book.status === 'Reading' ? 'blue' : book.status === 'On Hold' ? 'yellow' : 'gray') + '-800'">
                {{ book.status }}
              </span>
            </div>
            
            <div class="text-sm text-gray-600 dark:text-gray-300 mb-2">
              by {{ book.author }}
              <span *ngIf="book.publicationYear"> • {{ book.publicationYear }}</span>
              <span *ngIf="book.pages"> • {{ book.pages }} pages</span>
            </div>

            <div *ngIf="book.series" class="text-sm text-blue-600 dark:text-blue-400 mb-2">
              {{ book.series }} #{{ book.seriesOrder }}
            </div>
            
            <div class="flex flex-wrap gap-1 mb-2">
              <span *ngFor="let genre of book.genres" 
                    class="px-2 py-1 text-xs bg-gray-100 dark:bg-gray-600 text-gray-700 dark:text-gray-300 rounded">
                {{ genre }}
              </span>
            </div>
            
            <div *ngIf="book.rating" class="flex items-center gap-1">
              <div class="flex items-center">
                <span *ngFor="let star of [1,2,3,4,5]" 
                      class="text-yellow-400 text-sm"
                      [class.text-gray-300]="star > book.rating"
                      [class.dark:text-gray-600]="star > book.rating">
                  <i class="pi pi-star-fill"></i>
                </span>
              </div>
              <span class="text-sm text-gray-600 dark:text-gray-300">{{ book.rating }}/5</span>
            </div>
          </div>
        </div>
      </div>

      <!-- Series Overview -->
      <div class="bg-white dark:bg-gray-800 rounded-lg shadow-sm p-6">
        <h2 class="text-xl font-semibold text-gray-900 dark:text-white mb-4 flex items-center gap-2">
          <i class="pi pi-list"></i>
          Series Overview
        </h2>
        
        <div class="space-y-4">
          <div *ngFor="let series of getSeriesBooks() | keyvalue" class="border-l-4 border-blue-500 pl-4">
            <h3 class="font-semibold text-gray-900 dark:text-white mb-2">{{ series.key }}</h3>
            <div class="space-y-1">
              <div *ngFor="let book of series.value" class="text-sm text-gray-600 dark:text-gray-300">
                {{ book.seriesOrder }}. {{ book.title }}
                <span class="ml-2 px-2 py-0.5 text-xs rounded" 
                      [class]="'bg-' + (book.status === 'Read' ? 'green' : book.status === 'Reading' ? 'blue' : 'gray') + '-100 text-' + (book.status === 'Read' ? 'green' : book.status === 'Reading' ? 'blue' : 'gray') + '-800'">
                  {{ book.status }}
                </span>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- Sidebar Stats -->
    <div class="space-y-4">
      
      <!-- Genre Distribution -->
      <div class="bg-white dark:bg-gray-800 rounded-lg shadow-sm p-6">
        <h3 class="text-lg font-semibold text-gray-900 dark:text-white mb-4 flex items-center gap-2">
          <i class="pi pi-chart-pie"></i>
          Genre Distribution
        </h3>
        
        <div class="space-y-2">
          <div *ngFor="let genre of getGenreEntries()" class="flex justify-between items-center">
            <span class="text-sm text-gray-700 dark:text-gray-300">{{ genre[0] }}</span>
            <div class="flex items-center gap-2">
              <div class="w-16 h-2 bg-gray-200 dark:bg-gray-600 rounded-full overflow-hidden">
                <div class="h-full bg-blue-500" [style.width.%]="stats ? (genre[1] / stats.totalBooks) * 100 : 0"></div>
              </div>
              <span class="text-sm font-medium text-gray-900 dark:text-white w-6 text-right">{{ genre[1] }}</span>
            </div>
          </div>
        </div>
      </div>

      <!-- Publication Timeline -->
      <div class="bg-white dark:bg-gray-800 rounded-lg shadow-sm p-6">
        <h3 class="text-lg font-semibold text-gray-900 dark:text-white mb-4 flex items-center gap-2">
          <i class="pi pi-clock"></i>
          Publication Timeline
        </h3>
        
        <div class="space-y-2">
          <div *ngFor="let decade of getDecadeDistribution() | keyvalue" class="flex justify-between items-center">
            <span class="text-sm text-gray-700 dark:text-gray-300">{{ decade.key }}</span>
            <div class="flex items-center gap-2">
              <div class="w-12 h-2 bg-gray-200 dark:bg-gray-600 rounded-full overflow-hidden">
                <div class="h-full bg-green-500" [style.width.%]="stats ? (decade.value / stats.totalBooks) * 100 : 0"></div>
              </div>
              <span class="text-sm font-medium text-gray-900 dark:text-white w-6 text-right">{{ decade.value }}</span>
            </div>
          </div>
        </div>
      </div>

      <!-- Reading Status -->
      <div class="bg-white dark:bg-gray-800 rounded-lg shadow-sm p-6">
        <h3 class="text-lg font-semibold text-gray-900 dark:text-white mb-4 flex items-center gap-2">
          <i class="pi pi-check-circle"></i>
          Reading Status
        </h3>
        
        <div class="space-y-2">
          <div class="flex justify-between items-center">
            <span class="text-sm text-gray-700 dark:text-gray-300">Read</span>
            <span class="text-sm font-medium text-green-600 dark:text-green-400">{{ getStatusCount('Read') }}</span>
          </div>
          <div class="flex justify-between items-center">
            <span class="text-sm text-gray-700 dark:text-gray-300">Reading</span>
            <span class="text-sm font-medium text-blue-600 dark:text-blue-400">{{ getStatusCount('Reading') }}</span>
          </div>
          <div class="flex justify-between items-center">
            <span class="text-sm text-gray-700 dark:text-gray-300">Want to Read</span>
            <span class="text-sm font-medium text-gray-600 dark:text-gray-400">{{ getStatusCount('Want to Read') }}</span>
          </div>
          <div class="flex justify-between items-center">
            <span class="text-sm text-gray-700 dark:text-gray-300">On Hold</span>
            <span class="text-sm font-medium text-yellow-600 dark:text-yellow-400">{{ getStatusCount('On Hold') }}</span>
          </div>
        </div>
      </div>

      <!-- Top Rated Books -->
      <div *ngIf="stats && stats.topRatedBooks.length > 0" class="bg-white dark:bg-gray-800 rounded-lg shadow-sm p-6">
        <h3 class="text-lg font-semibold text-gray-900 dark:text-white mb-4 flex items-center gap-2">
          <i class="pi pi-star"></i>
          Top Rated Books
        </h3>
        
        <div class="space-y-3">
          <div *ngFor="let book of stats.topRatedBooks" class="flex justify-between items-start">
            <div class="flex-1">
              <div class="text-sm font-medium text-gray-900 dark:text-white">{{ book.title }}</div>
              <div class="text-xs text-gray-600 dark:text-gray-300">{{ book.author }}</div>
            </div>
            <div class="flex items-center gap-1 ml-2">
              <i class="pi pi-star-fill text-yellow-400 text-xs"></i>
              <span class="text-sm font-medium text-gray-900 dark:text-white">{{ book.rating }}</span>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- No Publisher Found -->
  <div *ngIf="!publisher" class="bg-white dark:bg-gray-800 rounded-lg shadow-sm p-8 text-center">
    <i class="pi pi-exclamation-triangle text-4xl text-gray-400 mb-4"></i>
    <h2 class="text-xl font-semibold text-gray-900 dark:text-white mb-2">Publisher Not Found</h2>
    <p class="text-gray-600 dark:text-gray-300 mb-4">The requested publisher could not be found.</p>
    <button 
      (click)="goBack()"
      class="inline-flex items-center gap-2 px-4 py-2 bg-purple-600 hover:bg-purple-700 text-white rounded-lg transition-colors font-medium"
    >
      <i class="pi pi-arrow-left text-sm"></i>
      <span>Return to Publishers</span>
    </button>
  </div>
</div>
