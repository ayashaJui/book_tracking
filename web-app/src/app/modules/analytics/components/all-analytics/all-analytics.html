<div class="p-6 space-y-8">
  <!-- Filters -->
  <div class="flex flex-wrap items-center gap-4">
    <p-select
      [options]="timeRanges"
      [(ngModel)]="selectedRange"
      optionLabel="label"
      placeholder="Select Time Range"
      class="w-56"
      (onChange)="onFilterChange()"
    >
    </p-select>

    <p-select
      [options]="genres"
      [(ngModel)]="selectedGenre"
      optionLabel="label"
      placeholder="Select Genre"
      class="w-56"
      (onChange)="onFilterChange()"
    >
    </p-select>

    <p-button
      label="Export CSV"
      icon="pi pi-download"
      (click)="exportData()"
    ></p-button>
  </div>

  <!-- Overview KPIs -->
  <div class="grid grid-cols-1 md:grid-cols-4 gap-6">
    <p-card header="Total Books Read" styleClass="text-center">
      <p class="text-3xl font-bold text-primary">{{ stats.totalBooks }}</p>
    </p-card>
    <p-card header="Pages Read" styleClass="text-center">
      <p class="text-3xl font-bold text-green-500">{{ stats.totalPages }}</p>
    </p-card>
    <p-card header="Average Rating" styleClass="text-center">
      <p class="text-3xl font-bold text-yellow-500">{{ stats.avgRating }}/5</p>
    </p-card>
    <p-card header="Total Hours" styleClass="text-center">
      <p class="text-3xl font-bold text-purple-500">{{ stats.totalHours }}</p>
    </p-card>
  </div>

  <!-- Charts Grid -->
  <div class="grid grid-cols-1 xl:grid-cols-2 gap-6">
    <p-card header="📈 Monthly Reading Trend" styleClass="shadow-md rounded-xl">
      <apx-chart
        [series]="readingTrendChart.series"
        [chart]="readingTrendChart.chart"
        [dataLabels]="readingTrendChart.dataLabels"
        [stroke]="readingTrendChart.stroke"
        [fill]="readingTrendChart.fill"
        [tooltip]="readingTrendChart.tooltip"
        [xaxis]="readingTrendChart.xaxis"
        [yaxis]="readingTrendChart.yaxis!"
        [grid]="readingTrendChart.grid!"
        [markers]="readingTrendChart.markers!"
        [legend]="readingTrendChart.legend!"
        [colors]="readingTrendChart.colors!"
      >
      </apx-chart>
    </p-card>

    <p-card header="🍰 Genre Distribution" styleClass="shadow-md rounded-xl">
      <apx-chart
        [series]="genrePieChart.series"
        [chart]="genrePieChart.chart"
        [labels]="genrePieChart.labels"
        [legend]="genrePieChart.legend"
        [responsive]="genrePieChart.responsive"
        [tooltip]="genrePieChart.tooltip!"
      >
      </apx-chart>
    </p-card>

    <p-card header="💰 Monthly Spending" styleClass="shadow-md rounded-xl">
      <apx-chart
        [series]="spendingBarChart.series"
        [chart]="spendingBarChart.chart"
        [plotOptions]="spendingBarChart.plotOptions"
        [dataLabels]="spendingBarChart.dataLabels"
        [xaxis]="spendingBarChart.xaxis"
        [yaxis]="spendingBarChart.yaxis!"
        [grid]="spendingBarChart.grid!"
        [tooltip]="spendingBarChart.tooltip!"
        [colors]="spendingBarChart.colors!"
      >
      </apx-chart>
    </p-card>

    <p-card
      header="🔥 Reading Streak (Heatmap)"
      styleClass="shadow-md rounded-xl"
    >
      <apx-chart
        [series]="heatmapChart.series"
        [chart]="heatmapChart.chart"
        [plotOptions]="heatmapChart.plotOptions"
        [dataLabels]="heatmapChart.dataLabels"
        [xaxis]="heatmapChart.xaxis"
        [yaxis]="heatmapChart.yaxis"
        [tooltip]="heatmapChart.tooltip"
        [grid]="heatmapChart.grid!"
        [colors]="heatmapChart.colors"
      >
      </apx-chart>
    </p-card>
  </div>

  <!-- Top Authors -->
  <p-card header="📚 Top Authors" styleClass="shadow-md rounded-xl">
    <p-table [value]="topAuthors" responsiveLayout="scroll">
      <ng-template pTemplate="header">
        <tr>
          <th class="w-2/3">Author</th>
          <th class="w-1/3 text-right">Books Read</th>
        </tr>
      </ng-template>
      <ng-template pTemplate="body" let-a>
        <tr>
          <td>{{ a.name }}</td>
          <td class="text-right">{{ a.books }}</td>
        </tr>
      </ng-template>
    </p-table>
  </p-card>
</div>
